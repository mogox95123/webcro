//tealium universal tag - utag.41 ut4.0.201803021426, Copyright 2018 Tealium.com Inc. All Rights Reserved.
window.tiq_formName=undefined;jQuery(document).ready(function(e){var identifyForm=function(interactedElement){if(!!interactedElement.attr("placeholder")&&interactedElement.attr("placeholder").match(/search/i)!==null){window.tiq_formName="Search Form (top nav)";}else if(!!interactedElement.attr("id")&&interactedElement.attr("id").match(/ResultsPageSmartSearchBox/i)!==null){window.tiq_formName="Search form (search page)";}else if(interactedElement.parents(".si-target").length>0){window.tiq_formName="Sign-in form (on page)";}else if(interactedElement.parents(".sign-in-flyout").length>0){window.tiq_formName="Sign-in form (flyout)";}else if(interactedElement.parents(".find-branch-wrapper").length>0){window.tiq_formName=jQuery(interactedElement.parents(".find-branch-wrapper").find(".row")[0]).text().trim()+" form";}else if(interactedElement.parents("#contactform").length>0){window.tiq_formName="Contact form";}else if(interactedElement.parents(".locate-advisor-form").length>0){window.tiq_formName="Locate Advisor form";}else if(!!utag_data&&!!utag_data["page_type"]){if(utag_data["page_type"].match(/CampaignLanding/i)!==null){window.tiq_formName=utag_data["page_name"]+" form";}else if(!!utag_data["page_name"]&&utag_data["page_name"].match(/Words.*on.*Wealth/i)!==null){window.tiq_formName="Words on Wealth Sign Up form";}}else if(!!interactedElement.parents("[id*=On_lineForm_viewBiz_pnlForm]").length>0){if(!!utag_data["page_name"]&&utag_data["page_name"].match(/credit.*card/i)!==null){window.tiq_formName="Credit Card form";}else if(jQuery("div.bio-hero-block:contains('Wealth Advisor')").length>0){window.tiq_formName="Contact Wealth Advisor form";}else if(jQuery("div.bio-hero-block:contains('Mobile Mortgage Specialist')").length>0){window.tiq_formName="Contact Mobile Mortgage Specialist form";}else if(jQuery("div.bio-hero-block:contains('Small Business Advisor')").length>0){window.tiq_formName="Contact Small Business Advisor form";}else if(!!utag_data["page_name"]&&utag_data["page_name"].match(/Contact.*Member.*Relations/i)!==null){window.tiq_formName="Contact Member Relations form";}else{window.tiq_formName="Form not identified";}}else{window.tiq_formName="Form not identified";}}
jQuery("input").on("focus",function(e){identifyForm(jQuery(this));});jQuery("textarea").on("focus",function(e){identifyForm(jQuery(this));});jQuery("select").on("focus",function(e){identifyForm(jQuery(this));});jQuery(document).on("submit",function(e){if(!!tiq_formName){utag.link({"event_name":"formSubmit","event_category":"Forms","event_action":"Submit","event_label":window.tiq_formName,"event_non_interaction":0});}});jQuery(document).on("click",'[data-track_action*="ctabutton_Sign"], [onclick*="search"]',function(e){if(!!tiq_formName){utag.link({"event_name":"formSubmit","event_category":"Forms","event_action":"Submit","event_label":window.tiq_formName,"event_non_interaction":0});}});});(function form_tracking_omo_IIFE(){try{var formHistory={},formSection={},lastSection;function getFieldSetLegend(element){if(!!document.querySelector&&!!document.querySelector("ul#steps li.selected")){return document.querySelector("ul#steps li.selected").textContent.trim();}else{return undefined;}}
function trackEvent(item,eventName,sectionName){var fHistory;sectionName=sectionName||getFieldSetLegend(item);if(!!sectionName&&!!formHistory[sectionName]){fHistory=formHistory[sectionName].join(" > ");utag.link({"event_name":"omoEvent","event_category":"Online Member Onboarding","event_action":"Form "+eventName,"event_label":sectionName+": "+fHistory,"event_non_interaction":0});formHistory[sectionName]=undefined;}}
if(!!document.querySelectorAll&&document.location.hostname.match("join.meridiancu.ca")!==-1){if(!!window.addEventListener){window.addEventListener('beforeunload',function(e){Array.prototype.slice.call(document.querySelectorAll("form")).forEach(function(it){if(!!lastSection){trackEvent(it,"Abandonment",lastSection);}});});if(!!document.querySelectorAll("a[onclick*=SectionValidation],a[onclick*=Agree],a[onclick*=Disagree]")){Array.prototype.slice.call(document.querySelectorAll("a[onclick*=SectionValidation],a[onclick*=Agree],a[onclick*=Disagree]")).forEach(function(item){var it=item;item.addEventListener("click",function(e){trackEvent(it,"Flow",getFieldSetLegend(it));lastSection=undefined;});});}
document.addEventListener("change",function(e){var target=e.target,fieldSet=getFieldSetLegend(target);if(target&&target.tagName&&(target.tagName.toLowerCase()=="input")||target.tagName.toLowerCase()=="select"||target.tagName.toLowerCase()=="textarea"){var inputName=target.getAttribute("name")||target.getAttribute("id");if(!!inputName&&!!fieldSet){lastSection=fieldSet;if(!formHistory[fieldSet]){formHistory[fieldSet]=[];}
if(formHistory[fieldSet].slice(-1)!=inputName){formHistory[fieldSet].push(inputName);}}}});}else if(!!window.attachEvent&&!!document.querySelectorAll){window.attachEvent('onbeforeunload',function(e){Array.prototype.slice.call(document.querySelectorAll("form")).forEach(function(it){trackEvent(it,"Abandonment",lastSection);});});if(!!document.querySelectorAll("a[onclick*=SectionValidation],a[onclick*=Agree],a[onclick*=Disagree]")){Array.prototype.slice.call(document.querySelectorAll("a[onclick*=SectionValidation],a[onclick*=Agree],a[onclick*=Disagree]")).forEach(function(item){var it=item;item.attachEvent("onclick",function(e){trackEvent(it,"Flow",getFieldSetLegend(it));lastSection=undefined;});});}
document.attachEvent("onchange",function(e){var target=e.target,fieldSet=getFieldSetLegend(target);if(target&&target.tagName&&(target.tagName.toLowerCase()=="input")||target.tagName.toLowerCase()=="select"||target.tagName.toLowerCase()=="textarea"){var inputName=target.getAttribute("name")||target.getAttribute("id");if(!!inputName&&!!fieldSet){lastSection=fieldSet;if(!formHistory[fieldSet]){formHistory[fieldSet]=[];}
if(formHistory[fieldSet].slice(-1)!=inputName){formHistory[fieldSet].push(inputName);}}}});}}}catch(e){}})();try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1};u.initialized=false;u.map={};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
}};utag.o[loader].loader.LOAD(id);})("41","meridian.main");}catch(error){utag.DB(error);}
